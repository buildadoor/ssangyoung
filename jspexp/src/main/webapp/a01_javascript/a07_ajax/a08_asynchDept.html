<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link href="/a00_com/a01_common.css" rel="stylesheet">
<style type="text/css">
/*
#비동기식으로 DB와 연동해서 요청값을 전달 처리하는 ajax 처리 순서
1. 화면 구성/form 하위 객체 선언
2. 사용할 DOM 선언
	1) value
	2) 이벤트 처리할 내용 (onclick, onkeyup(event, keyCode)...)
3. 이벤트 핸들러 함수 선언
	1) query string을 만들기(*)
		서버에 보낼 query string(key=value&key2=value2)
	2) ajax 처리할 내용
		객체 생성
		open 생성
		보내기
		onreadystatechange=function(){
			조건(상태 처리)
			xhr.resposeText
		}
4. 데이터를 처리할 jsp 화면 구성/json 구성
	1) 요청값 받기 
	2) DB연결 및 결과 처리
	
*/

</style>
<script>
/*
 
*/

</script>
</head>
<body>
<h2>부서정보검색</h2>
   <table>
      <col width="40%">
      <tr><th>부서명</th><td><input type="text" name="dname" /></td></tr>
      <tr><th>부서위치</th><td><input type="text" name="loc" /></td></tr>
      <tr><td colspan="2">
         <input type="button" id="schBtn" value="검색"/></td></tr>
   </table>
      <div id="container"></div>
</body>
<script type="text/javascript">
var dnameOb = document.querySelector("[name=dname]")
var locOb = document.querySelector("[name=loc]")
var schBtn = document.querySelector("#schBtn")
var div = document.querySelector("#container")
dnameOb.onkeyup=function(){
   if(event.keyCode==13) schQuery()    
}
locOb.onkeyup=function(){
   if(event.keyCode==13) schQuery()    
}
schBtn.onclick=schQuery;
function schQuery(){
   var qstr = "?dname="+dnameOb.value+"&loc="+locOb.value
   loadData(qstr)
}
function loadData(qstr){
   var xhr = new XMLHttpRequest()
   xhr.open("get","z07_DeptList.jsp"+qstr,true)
   xhr.send()
   xhr.onreadystatechange=function(){
      if(xhr.readyState==4&&xhr.status==200){
         div.innerHTML=xhr.responseText
      }
   }
}

/*
# 처리 순서
1. DOM 객체 선언(대상 객체, 검색객체)
2. 검색 요청값 처리 메서드 선언(공통) 
   : 페이지와 요청값을 queryString으로 만드는 공통 메서드
3. ajax처리 이벤트 핸들러 공통메서드
   1) XMLHttpRequest객체 생성
   2) 서버 호출
   3) 비동기 처리기능 메서드 선언
4. 이벤트 및 이벤트 핸들러 선언
   1) 공통 검색 메서드 선언
   2) 이벤트에 이벤트 핸들러 할당.
   
 */

// 
</script>
</html>